{% load static %}
{% if posts %}
<div class="kishiface-posts-grid">
    {% for post in posts %}
        {% if post.preview_type == 'video' %}
            <a href="{% url 'post_comment' post.post_id %}" class="kishiface-post-item">
                <div class="kishiface-video-thumbnail">
                    {% if post.video_file %}
                        <!-- Use video element with metadata preload for thumbnail -->
                        <video class="kishiface-preview-media" 
                               preload="metadata" 
                               muted 
                               playsinline
                               poster="{% static 'images/video-placeholder.jpg' %}">
                            <source src="{{ post.video_file.url }}#t=0.5" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="kishiface-video-overlay">
                            <i class="fas fa-play-circle"></i>
                        </div>
                    {% else %}
                        <div class="kishiface-placeholder" style="background-color: #000;"></div>
                        <div class="kishiface-video-overlay">
                            <i class="fas fa-play-circle"></i>
                        </div>
                    {% endif %}
                </div>
                <div class="kishiface-post-overlay">
                    <span><i class="fa-solid fa-heart"></i> {{post.likes.count}}</span>
                    <span><i class="fa-solid fa-comment"></i> {{post.comments.count}}</span>
                </div>
            </a>
        {% endif %}
    {% endfor %}
</div>
{% else %}
<div class="kishiface-no-posts">
    <h2 class="kishiface-no-posts-title">No videos yet</h2>
    <p class="kishiface-no-posts-text">When they post videos, they will show up here.</p>
</div>
{% endif %}