{% load humanize %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="{% static 'images/logo.jpg' %}" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
    /*
     * COMBINED STYLE: LinkedIn Boxed Card with Instagram Carousel Functionality
     */
    :root {
      --main-bg: #f0f2f5;
      --white: #ffffff;
      --border-color: #e0e0e0;
      --primary-color: #0077b5;
      --text-dark: #1f1f1f;
      --text-muted: #6a6a6a;
      --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    body {
      font-family: var(--font-stack);
      background-color: var(--white);
      margin: 0;
      padding-top: 54px;
      padding-bottom: 49px;
      color: var(--text-dark);
      min-height: 100vh;
    }
    /* ===== Header (Top Bar) ===== */
    header {
      position: fixed; top: 0; left: 0; right: 0;
      height: 54px;
      background: var(--white);
      border-bottom: 1px solid var(--border-color);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 16px;
      z-index: 1000;
    }
    header h1 {
      /* Keep the stylistic font for the logo */
      font-family: 'Billabong', cursive, 'Brush Script MT', cursive;
      font-size: 28px;
      font-weight: normal;
    }
    /* Updated: Added gap for the header icons */
    header .icon-group {
      display: flex;
      gap: 20px;
      align-items: center;
    }
    /* Updated: Changed icons to plane white with #666 color */
    header .icon-group i {
      font-size: 26px;
      color: #666;
      cursor: pointer;
      /* Remove any text-shadow that might be added by Font Awesome */
      text-shadow: none !important;
    }
    
    /* ===== Notification and Message Badge Styles ===== */
    .icon-badge-container {
      position: relative;
      display: inline-block;
    }
    
    .icon-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background-color: #ff3b30; /* Red color for alerts */
      color: white;
      border-radius: 10px;
      min-width: 18px;
      height: 18px;
      font-size: 11px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 4px;
      box-sizing: border-box;
      border: 1.5px solid var(--white);
      /* No shadow as requested */
      text-shadow: none;
      box-shadow: none;
    }
    
    /* Style for zero count - hide the badge */
    .icon-badge[data-count="0"] {
      display: none;
    }
    
    /* Message badge specific style */
    .message-badge {
      background-color: #007aff; /* Blue color for messages */
    }
    
    /* ===== Link Styles ===== */
    .icon-link {
      text-decoration: none;
      color: inherit;
      display: flex;
      align-items: center;
      position: relative;
    }
    /* ========Loading Styleb=====*/
    .kf-loading-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(255, 255, 255, 0.95);
    z-index: 9999; /* Higher z-index to stay above everything */
    justify-content: center;
    align-items: center;
    flex-direction: column;
}

.kf-loading-overlay.active {
    display: flex;
}

.kf-loading-spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid #0095f6; /* Your primary blue */
    border-radius: 50%;
    animation: kf-spin 1s linear infinite;
    margin-bottom: 20px;
}

.kf-loading-text {
    font-size: 16px;
    font-weight: 600;
    color: #262626;
    margin-bottom: 10px;
}

@keyframes kf-spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

    </style>
</head>
<body>
  
<div class="kf-loading-overlay" id="globalLoadingOverlay">
    <div class="kf-loading-spinner"></div>
    <div class="kf-loading-text" id="globalLoadingText">Processing...</div>
    <div class="kf-loading-subtext">Please wait while we handle your request. This may take a moment.</div>
</div>

  <header>
  <h1>KishiFace</h1>
  <div class="icon-group">
    <!-- Notification Icon with Badge -->
    <a href="{% url 'notification_list' %}" class="icon-link">
      <div class="icon-badge-container">
        <i class="fa-regular fa-bell"></i>
        <div class="icon-badge" id="notification-badge">
          <span
            hx-get="{% url 'notification_partial' %}"
            hx-trigger="every 0.15s"
            hx-target="#notification-badge"
            hx-swap="outerHTML"   
          >
          {% include 'snippet/notification_count.html' %}
          </span>
        </div>
      </div>
    </a>
    
    <!-- Message Icon with Badge -->
    <a href="{% url 'inbox' %}" class="icon-link">
      <div class="icon-badge-container">
        <i class="fa-regular fa-envelope"></i>
        <div class="icon-badge message-badge" id="message-badge">
          <span
            hx-get="{% url 'inbox_partial' %}"
            hx-trigger="every 1s"
            hx-target="#message-badge"
            hx-swap="outerHTML"   
          >
          {% include 'snippet/inbox_count.html' %}
          </span>
        </div>
      </div>
    </a>
  </div>
</header>

{% include 'info.html' %}
<script>
  // Automatically show loading notification on ANY form submission
document.addEventListener('submit', function(e) {
    const overlay = document.getElementById('globalLoadingOverlay');
    const loadingText = document.getElementById('globalLoadingText');
    
    if (overlay) {
        // Change text based on the specific page if needed
        if (e.target.id === 'postForm') {
            loadingText.textContent = "Sharing your post...";
        } else {
            loadingText.textContent = "Loading...";
        }
        
        overlay.classList.add('active');
    }
});

</script>
</body>
</html>