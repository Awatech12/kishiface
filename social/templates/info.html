<!-- Kishiface Toast Notification with Sound -->
<style>
    #kishiface-toast-container {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 999999;
        display: flex;
        flex-direction: column;
        gap: 12px;
        pointer-events: none;
    }

    .kishiface-toast {
        display: flex;
        align-items: center;
        gap: 10px;

        background: rgba(0, 0, 0, 0.85);
        color: #fff;

        padding: 12px 18px;
        border-radius: 28px;

        font-size: 14px;
        font-weight: 500;

        backdrop-filter: blur(5px);

        animation: kishifaceSlideUp 0.45s ease,
                   kishifaceFade 0.5s ease 3s forwards;
    }

    .kishiface-toast .kishiface-icon {
        font-size: 18px;
        font-weight: bold;
    }

    .kishiface-toast.success {
        background: rgba(0, 150, 0, 0.85);
    }
    .kishiface-toast.success .kishiface-icon {
        color: #4caf50;
    }

    .kishiface-toast.error {
        background: rgba(200, 0, 0, 0.85);
    }
    .kishiface-toast.error .kishiface-icon {
        color: #ff5252;
    }

    .kishiface-toast.warning {
        background: rgba(255, 165, 0, 0.85);
    }
    .kishiface-toast.warning .kishiface-icon {
        color: #ffca28;
    }

    @keyframes kishifaceSlideUp {
        from {
            opacity: 0;
            transform: translate(-50%, 40px);
        }
        to {
            opacity: 1;
            transform: translate(-50%, 0);
        }
    }

    @keyframes kishifaceFade {
        to {
            opacity: 0;
            transform: translate(-50%, 40px);
        }
    }
</style>

<!-- Toast Container -->
<div id="kishiface-toast-container">
    {% for message in messages %}
        <div class="kishiface-toast {{ message.tags }}" data-type="{{ message.tags }}">
            <span class="kishiface-icon">
                {% if message.tags == 'success' %}
                    ✓
                {% elif message.tags == 'error' %}
                    ✖
                {% elif message.tags == 'warning' %}
                    ⚠
                {% else %}
                    ℹ
                {% endif %}
            </span>
            <span>{{ message }}</span>
        </div>
    {% endfor %}
</div>

<script>
/* Base64 sound effects */
const sounds = {
    success: new Audio("data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCA…"),  // soft ding
    error: new Audio("data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCA…"),    // error beep
    warning: new Audio("data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCA…"),  // alert tone
    info: new Audio("data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCA…")      // soft pop
};

/* Play sound for each toast */
document.querySelectorAll(".kishiface-toast").forEach(toast => {
    const type = toast.getAttribute("data-type");
    if (sounds[type]) {
        sounds[type].play().catch(()=>{});
    } else {
        sounds["info"].play().catch(()=>{});
    }
});

/* Auto-remove after 3.5s */
setTimeout(() => {
    document.querySelectorAll(".kishiface-toast").forEach(t => t.remove());
}, 3500);
</script>